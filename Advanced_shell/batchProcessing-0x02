#!/bin/bash

# Create output directory if it doesn't exist
mkdir -p pokemon_data

# List of Pokémon names
pokemon_list=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")

# Loop through each Pokémon
for name in "${pokemon_list[@]}"
do
    lower_name=$(echo "$name" | tr '[:upper:]' '[:lower:]')
    echo "Fetching data for $lower_name..."

    # Fetch data using curl
    curl -s "https://pokeapi.co/api/v2/pokemon/$lower_name" -o "pokemon_data/$lower_name.json"

    if [[ $? -eq 0 ]]; then
        echo "Saved data to pokemon_data/$lower_name.json ✅"
    else
        echo "Failed to fetch data for $lower_name ❌"
    fi

    sleep 1
done

API_URL="https://pokeapi.co/api/v2/pokemon"
DATA_DIR="pokemon_data"
LOG_FILE="error.log"

mkdir -p "$DATA_DIR"
> "$LOG_FILE"  # clear previous errors

POKEMONS=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")

for name in "${POKEMONS[@]}"; do
    success=false
    for attempt in {1..3}; do
        echo "Fetching $name (Attempt $attempt)..."
        response=$(curl -s -f "$API_URL/$name")

        if [ $? -eq 0 ]; then
            echo "$response" > "$DATA_DIR/$name.json"
            success=true
            echo "$name fetched successfully."
            break
        else
            echo "Attempt $attempt failed for $name."
            sleep 1  # optional: wait before retry
        fi
    done

    if [ "$success" = false ]; then
        echo "Failed to fetch $name after 3 attempts." | tee -a "$LOG_FILE"
    fi
done

